{% extends "extends/html5boilerplate.njk" %}

{% set title = (title + " - " + site.title) if title else (site.title) %}
{% set description = (description) if description else (site.description) %}
{% set lang = lang | default(site.lang) %}

{% block headStyles %}
    {% include "partials/styles-critical.njk" %}
    {% include "partials/styles.njk" %}
    {% include "partials/scripts.njk" %}
{% endblock %}

{% block headMisc %}
    <link rel="manifest" href="/site.webmanifest">
    <link rel="apple-touch-icon" href="/assets/img/icon.png">
{% endblock %}

{% block body %}
    {{ super() }}

    {{ content | safe }}
{% endblock %}

{% block bodyScripts %}
    <script type="text/javascript">
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js').then(registration => {
                    // Registration was successful
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                })
                .catch(error => {
                    // registration failed :(
                    console.log('ServiceWorker registration failed: ', error);
                });
            });
        }
    </script>

    {% if config.env === 'development' %}
        {% include "partials/browser-sync.dev.njk" %}
    {% endif %}

{% endblock %}
